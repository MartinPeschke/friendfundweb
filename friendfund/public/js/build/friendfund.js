/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

if(!dojo._hasResource["friendfund.EmailFriendSelector"]){dojo._hasResource["friendfund.EmailFriendSelector"]=true;dojo.provide("friendfund.EmailFriendSelector");dojo.provide("friendfund.EmailInPlaceSelector");dojo.declare("friendfund._Selector",null,{_listener_locals:[],_loader:"<div style=\"margin: 0px auto;text-align:center;padding:30px;\"><div class=\"loading_animation\"><img src=\"/static/imgs/ajax-loader.gif\"></div></div>",draw:function(){},destoy:function(){},uninviteAppendNode:function(_1){},inviteAppendNode:function(_2){}});dojo.declare("friendfund.EmailFriendSelector",friendfund._Selector,{_listener_locals:[],rootNode:null,constructor:function(_3){dojo.mixin(this,_3);this.ref_node=dojo.isString(this.ref_node)&&dojo.byId(this.ref_node)||this.ref_node;},draw:function(){if(this.rootNode){dojo.removeClass(this.rootNode,"hidden");dojo.query("input[type=text]",this.rootNode)[0].focus();}else{this.rootNode=dojo.create("DIV",{"id":("networkinviter_"+this.network)});dojo.byId(this.ref_node).appendChild(this.rootNode);dojo.place(this._loader,this.rootNode,"only");ff.io.xhrPost(this.base_url+"/"+this.network,{},dojo.hitch(this,"onLoad"));}},onLoad:function(_4){dojo.place(_4,this.rootNode,"only");this._listener_locals.push(dojo.connect(this.ref_node,"onclick",this,"selectClick"));this._listener_locals.push(dojo.connect(this.ref_node,"onkeydown",dojo.hitch(this,ff.t.accessability,dojo.hitch(this,"select"),function(){})));ff.w.parseDefaultsInputs(this.rootNode);dojo.query("input[type=text]",this.rootNode)[0].focus();},undraw:function(){dojo.addClass(this.rootNode,"hidden");},destroy:function(){this.rootNode=null;dojo.forEach(this._listener_locals,dojo.disconnect);this._listener_locals=[];},selectClick:function(_5){if(_5.target.id==="emailsubmitter"){this.select(_5);}},select:function(_6){var _7=dojo.byId("email_email");if(_7&&_7.value.length>0){ff.io.xhrFormPost(this.base_url+"/validate","emailinviter",dojo.hitch(this,"_onSelect"));}},_onSelect:function(_8){if(_8.success===true){this.onSelect(_8.html,null);dojo.place(_8.input_html,this.rootNode,"only");}else{dojo.place(_8.html,this.rootNode,"only");}var _9=dojo.query("input[type=text]",this.rootNode)[0];ff.w.parseDefaultsInputs(this.rootNode);if(_9){_9.focus();}},onSelect:function(_a,_b){this.inviteAppendNode(_a);var el=dojo.byId("invitedCounter");el.innerHTML=parseInt(el.innerHTML,10)+1;},unSelect:function(_c){dojo.query(_c).orphan();elem=dojo.byId("invitedCounter");elem.innerHTML=parseInt(elem.innerHTML,10)-1;},inviteAppendNode:function(_d){dojo.place(_d,this.invited_node,"last");dojo.query("input[type=text]","emailinviter").attr("value","");dojo.query("#email_inviter_error","emailinviter").orphan();}});dojo.declare("friendfund.EmailInPlaceSelector",friendfund.EmailFriendSelector,{selectedValueNode:"selectedReceiver",constructor:function(_e){dojo.mixin(this,_e);this.selectedValueNode=dojo.byId(this.selectedValueNode);this.ref_node=dojo.isString(this.ref_node)&&dojo.byId(this.ref_node)||this.ref_node;},_onSelect:function(_f){var _10=this;if(_f.success===true){this.onSelect(_f.html,null);_10.selectedValueNode.value=_f.user_data;dojo.place(_f.html,this.rootNode,"only");dojo.query(".close",this.rootNode).onclick(dojo.hitch(this,"unSelect"));}else{dojo.place(_f.html,this.rootNode,"only");ff.w.parseDefaultsInputs(this.rootNode);}},onSelect:function(_11,evt){},unSelect:function(_12){this.selectedValueNode.value="";dojo.query(this.rootNode).orphan();this.destroy();this.draw();}});}if(!dojo._hasResource["friendfund.NetworkFriendSelector"]){dojo._hasResource["friendfund.NetworkFriendSelector"]=true;dojo.provide("friendfund.NetworkFriendSelector");dojo.provide("friendfund.FriendTypeAhead");dojo.declare("friendfund.NetworkFriendPanel",friendfund._Selector,{constructor:function(_13){dojo.mixin(this,_13);},draw:function(){ff.io.xhrPost(this.base_url+"/"+this.network,{},dojo.hitch(this,"onLoad"));},onLoad:function(_14){dojo.place(_14.html,this.ref_node,"only");dojo.style(this.ref_node,"display","Block");},destroy:function(){dojo.forEach(this._listener_locals,dojo.disconnect);this._listener_locals=[];},select:function(evt){var _15=ff.t.findParent(evt.target,"invitee_row");if(_15){return this.onSelect(_15,evt);}}});dojo.declare("friendfund.DataProvider",friendfund.NetworkFriendPanel,{_selected:{},constructor:function(_16){dojo.mixin(this,_16);this._rendering=false;this._current_display_idx=0;this._fully_loaded=false;this._search_index={};},addToSearchIndex:function(ud){ud["dom_id"]=this.network+"_"+ud.network_id;var s,_17,i,j,k,tmp,_18={};s=ud.name.split(" ").concat([ud.name]);for(i=0;i<s.length;i++){_17=s[i];for(j=0;j<=_17.length;j++){k=_17.substr(0,j).toLowerCase();_18[k]=true;}}for(k in _18){tmp=this._search_index[k]||[];if(tmp.push){tmp.push(ud);this._search_index[k]=tmp;}}if(this.current_filter.length&&_18[this.current_filter]){this.renderUserAndPlace(ud);}},_addPage:function(_19,_1a){var i,ud;for(i=0;i<_19.length;i++){ud=_19[i];this.addToSearchIndex(ud);}this._fully_loaded=_1a;},renderSlice:function(_1b,_1c){var _1d=ff.t.render,_1e=this.friends_template,sel=this._selected,_1f=this.mutuals,si=this._search_index[this.current_filter||""]||[],_20=[],_21=[],len=si.length,i;for(i=this._current_display_idx;i<len;i++){if(!sel[si[i].dom_id]&&(!_1f||_1f&&si[i].mutual_with)){_20.push(si[i]);}if(_20.length<=_1b){this._current_display_idx++;}}len=_20.length>_1b?_1b:_20.length;for(i=0;i<len;i++){_21.push(_1d(_1e,_20[i]));}if(_1c){_21.push("<li id=\"loading_placeholder_"+this.network+"\" class=\"clear\">&nbsp;</li>");}return _21;},getFirstPage:function(){this._current_display_idx=0;return this.renderSlice(this._page_size,true);},getNextPage:function(){return this.renderSlice(this._page_size);},hasMoreFriends:function(){return !this._fully_loaded||this._current_display_idx<this._search_index[this.current_filter||""].length;},reRender:function(){var _22=this.getFirstPage();if(_22.length){dojo.place(_22.join(""),this.friendlist,"only");this.onResultsFound();}else{delete dojo.query("*",this.friendlist).orphan();this.onNoResultsFound();}},onResultsFound:function(){},onNoResultsFound:function(){},_checkScrollingState:function(evt){friendlist_loader=dojo.byId("loading_placeholder_"+this.network);if(!friendlist_loader){return;}var pos=dojo.position(friendlist_loader);if(pos.y<this.friendlist_box){if(this.hasMoreFriends()){dojo.place(this.getNextPage().join(""),friendlist_loader,"before");}}},renderUserAndPlace:function(_23){dojo.place(ff.t.render(this.friends_template,_23),this.friendlist,"last");},addLoad:function(_24){if(_24.friends){this._addPage(_24.friends,_24.is_complete);if(!_24.is_complete){ff.io.xhrPost(this.base_url+"/ext_"+this.network,{offset:_24.offset},dojo.hitch(this,"addLoad"));}}},draw:function(){if(this.rootNode){dojo.removeClass(this.rootNode,"hidden");this.connect();}else{if(!this.is_selected()||this._is_loading!==true){this._is_loading=true;var l=dojo.query("#networkinviter_"+this.network);if(l.length){l.orphan();}this.rootNode=dojo.create("DIV",{"id":("networkinviter_"+this.network)});dojo.byId(this.ref_node).appendChild(this.rootNode);dojo.place(this._loader,this.rootNode,"only");ff.io.xhrPost(this.base_url+"/"+this.network,{},dojo.hitch(this,"onLoad"));}}}});dojo.declare("friendfund.NetworkFriendSelector",friendfund.DataProvider,{rootNode:null,_is_loading:false,_page_size:20,current_filter:"",constructor:function(_25){dojo.mixin(this,_25);if(this.invited_node){this.invited_node=dojo.isString(this.invited_node)&&dojo.byId(this.invited_node)||this.invited_node;}else{this.invited_node=null;}_is_selected_decider=".methodselector.ajaxlink.selected[_type="+this.network+"]";this.lazyReRender=ff.t.debounce(dojo.hitch(this,"reRender"),200,false);this.checkScrollingState=ff.t.debounce(dojo.hitch(this,"_checkScrollingState"),100,false);},is_selected:function(){return dojo.query(this._is_selected_decider,this.container).length>0;},connect:function(){},undraw:function(){if(this.rootNode){dojo.addClass(this.rootNode,"hidden");}else{var l=dojo.query("#networkinviter_"+this.network);if(l.length){l.orphan();}}dojo.forEach(this._listener_locals,dojo.disconnect);this._listener_locals=[];},onLoad:function(_26){var _27=this;_27._is_loading=false;dojo.place(_26.html,_27.rootNode,"only");if(_26.success){_27.friendlist=dojo.byId("friend_list_"+_27.network);_27.friendlist_box=dojo.position(_27.friendlist.parentNode);_27.friendlist_box=_27.friendlist_box.h*2+_27.friendlist_box.y;var _28=dojo.byId("toggle_mutuals_"+_27.network);if(_28){dojo.connect(_28,"onclick",_27,"toggle_mutuals");_27.mutuals=_28.checked;}else{_27.mutuals=false;}_27.friends_template=_26.template;_27._addPage(_26.friends,_26.is_complete);_27.reRender();_27.filterNode=dojo.byId("filter_"+_27.network);dojo.connect(_27.friendlist,"onclick",_27,"select");dojo.connect(_27.filterNode,"onkeyup",_27,"filter");ff.w.parseDefaultsInputs(_27.ref_node);dojo.connect(_27.friendlist.parentNode,"onscroll",this.checkScrollingState);if(!_26.is_complete){ff.io.xhrPost(_27.base_url+"/ext_"+_27.network,{offset:_26.offset},dojo.hitch(_27,"addLoad"));}}else{dojo.query("a.facebookBtn",_27.rootNode).forEach(function(_29){level=parseInt(dojo.attr(_29,"_level"),10);dojo.connect(_29,"onclick",dojo.hitch(_27.auth_provider,"doFBLogin",{level:level,success:dojo.hitch(_27,"draw")}));});dojo.query("a.twitterBtn",_27.rootNode).forEach(function(_2a){level=parseInt(dojo.attr(_2a,"_level"),10);dojo.connect(_2a,"onclick",dojo.hitch(_27.auth_provider,"doTWLogin",{level:level,success:dojo.hitch(_27,"draw")}));});_27.rootNode=null;}},onSelect:function(_2b,evt){this.checkScrollingState();dojo.query("p.inviterTwo",this.global_invited_node).addClass("hidden");this.inviteAppendNode(_2b);var el=dojo.byId("invitedCounter");el.innerHTML=parseInt(el.innerHTML,10)+1;},inviteAppendNode:function(_2c){var _2d=this;dojo.query(_2c).orphan().forEach(function(_2e){dojo.place(_2e,_2d.invited_node,"last");_2d._selected[_2e.id]=true;});},uninviteAppendNode:function(_2f){delete this._selected[_2f.id];this.lazyReRender();},unSelect:function(_30){var _31=this;dojo.query(_30).orphan().forEach(function(_32){_31.uninviteAppendNode(_32);var ctr=dojo.byId("invitedCounter");var _33=parseInt(ctr.innerHTML,10)-1;ctr.innerHTML=_33;if(_33===0){dojo.query("p.inviterTwo",_31.global_invited_node).removeClass("hidden");}});},toggle_mutuals:function(evt){this.mutuals=evt.target.checked;this.lazyReRender();},filter:function(evt){if(evt.keyCode==27){this.filterNode.value="";this.current_filter="";}else{if(evt.keyCode<45&&evt.keyCode!=8){return;}}this.current_filter=this.filterNode.value.toLowerCase();this.lazyReRender();}});dojo.declare("friendfund.FriendTypeAhead",friendfund.DataProvider,{rootNode:null,_is_loading:false,_page_size:5,current_filter:"",_has_results:false,selectedValueNode:"selectedReceiver",constructor:function(_34){dojo.mixin(this,_34);this._is_selected_decider=".methodselector.ajaxlink.selected[_type="+this.network+"]";this.lazyReRender=ff.t.debounce(dojo.hitch(this,"reRender"),100,false);this.mutuals=false;this.selectedValueNode=dojo.byId(this.selectedValueNode);this.checkScrollingState=ff.t.debounce(dojo.hitch(this,"_checkScrollingState"),100,false);},is_selected:function(){return dojo.query(this._is_selected_decider,this.container).length>0;},connect:function(){this._listener_locals.push(dojo.connect(this.friendlist,"onclick",this,"select"));this._listener_locals.push(dojo.connect(this.filterNode,"onkeyup",this,"filter"));this._listener_locals.push(dojo.connect(window,"onclick",this,"onHideSelector"));this._listener_locals.push(dojo.connect(this.filterNode,"onfocus",this,"onShowSelector"));this._listener_locals.push(dojo.connect(this.friendlist.parentNode,"onscroll",this.checkScrollingState));},onHideSelector:function(evt){if(!ff.t.findParent(evt.target,"typeAheadSelector")){this.hideSelector();}},hideSelector:function(){var pn=ff.t.findParent(this.friendlist,"friendsList");dojo.addClass(pn,"hidden");},onShowSelector:function(evt){evt.target.select();this.reRender();var tmp=dojo.position(this.friendlist.parentNode);this.friendlist_box=this.friendlist_box||tmp.y+tmp.h*1.5;},showSelector:function(){if(this._has_results){var pn=ff.t.findParent(this.friendlist,"friendsList");dojo.removeClass(pn,"hidden");}},undraw:function(){if(this.rootNode){dojo.addClass(this.rootNode,"hidden");}else{var l=dojo.query("#networkinviter_"+this.network);if(l.length){l.orphan();}}dojo.forEach(this._listener_locals,dojo.disconnect);this._listener_locals=[];},onLoad:function(_35){var _36=this;_36._is_loading=false;dojo.place(_35.html,_36.rootNode,"only");if(_35.success){_36.friendlist=dojo.byId("friend_list_"+_36.network);_36.friends_template=_35.template;_36._addPage(_35.friends,_35.is_complete);_36.filterNode=dojo.byId("filter_"+_36.network);ff.w.parseDefaultsInputs(_36.ref_node);_36.connect();if(!_35.is_complete){ff.io.xhrPost(_36.base_url+"/ext_"+_36.network,{offset:_35.offset},dojo.hitch(_36,"addLoad"));}}else{dojo.query("a.facebookBtn",_36.rootNode).forEach(function(_37){level=parseInt(dojo.attr(_37,"_level"),10);dojo.connect(_37,"onclick",dojo.hitch(_36.auth_provider,"doFBLogin",{level:level,success:dojo.hitch(_36,"draw")}));});dojo.query("a.twitterBtn",_36.rootNode).forEach(function(_38){level=parseInt(dojo.attr(_38,"_level"),10);dojo.connect(_38,"onclick",dojo.hitch(_36.auth_provider,"doTWLogin",{level:level,success:dojo.hitch(_36,"draw")}));});_36.rootNode=null;}},onResultsFound:function(){this._has_results=true;this.showSelector();},onNoResultsFound:function(){this._has_results=false;this.hideSelector();},onSelect:function(_39,evt){this.inviteAppendNode(_39);},inviteAppendNode:function(_3a){var _3b=this;var pn=ff.t.findParent(_3b.friendlist,"typeAheadSelector");dojo.query("img.smallProfPic",pn).orphan();dojo.query("img",_3a).forEach(function(n){var _3c=dojo.create("IMG",{src:n.src,className:"smallProfPic"});dojo.place(_3c,pn,"first");});_3b.filterNode.value=dojo.query("p",_3a).attr("innerHTML").join("");_3b.current_filter=_3b.filterNode.value.toLowerCase();dojo.addClass(_3b.filterNode,"selected");_3b.reRender();_3b.selectedValueNode.value=dojo.query("input",_3a).attr("value").join("");},uninviteAppendNode:function(_3d){},unSelect:function(_3e){},filter:function(evt){if(evt.keyCode==27){this.filterNode.value="";this.current_filter="";}else{if(evt.keyCode<45&&evt.keyCode!=8){return;}}this.current_filter=this.filterNode.value.toLowerCase();this.lazyReRender();}});}if(!dojo._hasResource["friendfund.CompoundFriendSelector"]){dojo._hasResource["friendfund.CompoundFriendSelector"]=true;dojo.provide("friendfund.CompoundFriendSelector");dojo.declare("friendfund.CompoundFriendSelector",null,{_widget_locals:[],_listener_locals:[],selectors:{},constructor:function(_3f){var _40=this;dojo.mixin(_40,_3f);this.networkSelector=this.networkSelector||friendfund.NetworkFriendSelector;this.emailSelector=this.emailSelector||friendfund.EmailFriendSelector;if(_3f.avail_selectors.facebook===true){_40.selectors.facebook=new this.networkSelector({container:_40.container,auth_provider:_40.auth_provider,ref_node:_40.ref_node,invited_node:"network"+_40.invited_node_suffix,global_invited_node:_40.global_invited_node,base_url:_40.base_url,network:"facebook"});}if(_3f.avail_selectors.twitter===true){_40.selectors.twitter=new this.networkSelector({container:_40.container,auth_provider:_40.auth_provider,ref_node:_40.ref_node,invited_node:"network"+_40.invited_node_suffix,global_invited_node:_40.global_invited_node,base_url:_40.base_url,network:"twitter"});}if(_3f.avail_selectors.email===true){_40.selectors.email=new this.emailSelector({ref_node:_40.ref_node,auth_provider:_40.auth_provider,invited_node:"network"+_40.invited_node_suffix,global_invited_node:_40.global_invited_node,base_url:_40.base_url,network:"email"});}for(var sel in _40.selectors){var s=_40.selectors[sel];if(_40.selectors.hasOwnProperty(sel)&&_40.selectors[sel]){if(_40.onSelect){s.onSelect=dojo.hitch(s,_40.onSelect);}if(_40.unSelect){s.unSelect=dojo.hitch(s,_40.unSelect);}_40._widget_locals.push(s);}}if(_40.invited_node_suffix){_40._listener_locals.push(dojo.connect(dojo.byId(_40.global_invited_node),"onclick",_40,"unselect"));}var _41=dojo.byId("removeall");if(_41){_40._listener_locals.push(dojo.connect(_41,"onclick",_40,"removeAll"));}},removeAll:function(){var _42=this;dojo.query(".invitee_row.selectable",_42.global_invited_node).forEach(function(_43){_42.selectors[dojo.attr(_43,"_network")].unSelect(_43);});},unselect:function(evt){var _44=ff.t.findParent(evt.target,"invitee_row");if(!_44||!dojo.hasClass(_44,"selectable")){return;}this.selectors[dojo.attr(_44,"_network")].unSelect(_44);},destroy:function(){dojo.forEach(this._listener_locals,dojo.disconnect);this._listener_locals=[];dojo.forEach(this._widget_locals,function(_45){_45.destroy();});this._widget_locals=[];},switchMethod:function(evt){var _46=this;if(dojo.hasClass(evt.target,"selected")){return;}dojo.query(".ajaxlink.selected",_46.container).forEach(function(_47){dojo.removeClass(_47,"selected");var _48=_46.selectors[dojo.attr(_47,"_type")];if(_48){_48.undraw();}});dojo.addClass(evt.target,"selected");var _49=_46.selectors[dojo.attr(evt.target,"_type")];if(_49){_49.draw();}},draw:function(_4a){var _4b=this;_4b.selectors[_4a].draw();dojo.query(".ajaxlink",_4b.container).forEach(function(_4c){_4b._listener_locals.push(dojo.connect(_4c,"onclick",_4b,"switchMethod"));});}});}if(!dojo._hasResource["friendfund.InvitePage"]){dojo._hasResource["friendfund.InvitePage"]=true;dojo.provide("friendfund.InvitePage");dojo.declare("friendfund.InvitePage",null,{selector:null,_listener_locals:[],_widget_locals:[],submitting:false,constructor:function(_4d){var _4e=this;dojo.mixin(_4e,_4d);_4e.selector=new friendfund.CompoundFriendSelector({auth_provider:_4e.auth_provider,container:_4e.container,ref_node:"inviter",invited_node_suffix:"_invitees",inviter_node:"friend_list",base_url:_4e.base_url,global_invited_node:_4e.invited_node,avail_selectors:{"facebook":true,"twitter":true,"email":true}});_4e._widget_locals.push(_4e.selector);dojo.connect(document,"onclick",dojo.hitch(null,_4e.loadPreviewPopup,_4e,_4e.method));},loadPreviewPopup:function(_4f,_50,evt){if(dojo.hasClass(evt.target,"message_preview")){dojo.query("input.addRefContent",_4f.target_form).forEach(function(_51){_51.value=dojo.byId(dojo.attr(_51,"_source")).value;});params=dojo.formToObject(_4f.target_form);params.method=dojo.attr(evt.target,"_method");ff.io.xhrPost(dojo.attr(evt.target,"_href"),params);}},prepareSubmit:function(_52,_53,evt){ff.t.onSubmitCleaner(_52.target_form);if(_52.submitting){return false;}_52.submitting=true;return _52.auth_provider.checkLogin({level:_53,success:dojo.hitch(_52,"_submit"),fail:function(){_52.submitting=false;}});},_submit:function(){var _54=this;dojo.forEach(_54._widget_locals,function(_55){_55.destroy(_55);});_54._widget_locals=[];_54.receiver_selectors={};dojo.query("input.addRefContent",_54.target_form).forEach(function(_56){_56.value=dojo.byId(dojo.attr(_56,"_source")).value;});dojo.byId(_54.target_form).submit();}});}if(!dojo._hasResource["friendfund.PartnerPanel"]){dojo._hasResource["friendfund.PartnerPanel"]=true;dojo.provide("friendfund.PartnerPanel");dojo.declare("friendfund.PartnerPanel",null,{constructor:function(_57){var _58=this;dojo.mixin(_58,_57);_58.triedSubmitting=false;_58.target_form=dojo.isString(_58.target_form)&&dojo.byId(_58.target_form)||_58.target_form;_58.connect();_58.load_receiver();},connect:function(){var _59=this;if(dojo.byId("productSelector")){dojo.connect(dojo.byId("productSelector"),"onchange",dojo.hitch(_59,_59.swapProduct));}if(dojo.byId("occasionSelector")){dojo.connect(dojo.byId("occasionSelector"),"onchange",dojo.hitch(_59,_59.swapOccasionName));}dojo.connect(dojo.byId("occasionTyper"),"onkeyup",dojo.hitch(_59,_59.changeOccasionName));},changeOccasionName:function(evt){var _5a=this;if(evt.target.value){dojo.byId(dojo.attr(evt.target,"_target")).value=evt.target.value;}else{var _5b={target:dojo.byId("occasionSelector")};this.swapOccasionName(_5b);}_5a.check_occasion_name();},swapOccasionName:function(evt){var _5c=this;var _5d=evt.target.options[evt.target.selectedIndex];dojo.byId(dojo.attr(evt.target,"_name_target")).value=_5d.value;dojo.byId(dojo.attr(evt.target,"_key_target")).value=dojo.attr(_5d,"key");_5c.check_occasion_name();},swapProduct:function(evt){var _5e=evt.target.options[evt.target.selectedIndex];dojo.query(".selectedProduct","productArea").removeClass("selectedProduct").addClass("hidden");dojo.query("#product_"+dojo.attr(_5e,"_guid")).addClass("selectedProduct").removeClass("hidden");},load_receiver:function(){var _5f=this;_5f.selector=new friendfund.CompoundFriendSelector({auth_provider:_5f.auth_provider,container:_5f.container,ref_node:"inviter",invited_node_suffix:"_invitees",inviter_node:"friend_list",base_url:_5f.base_url,mutuals:false,global_invited_node:_5f.invited_node,avail_selectors:{"facebook":true,"twitter":true,"email":true},onSelect:function(_60,evt){_5f.selector.removeAll();this.inviteAppendNode(_60);dojo.addClass(_5f.invited_node,"filled");_5f.check_receiver();return true;},unSelect:function(_61){dojo.query("#"+_61.id,this.invited_node).orphan().forEach(dojo.hitch(this,"uninviteAppendNode"));dojo.removeClass(_5f.invited_node,"filled");}});_5f.selector.draw(_5f.method);},submit:function(url,_62,evt){var _63=this;var _64=_63.checkCompleteness();if(!_64||_63.submitting){return false;}else{ff.t.onSubmitCleaner(_63.target_form);_63.submitting=true;return _63.auth_provider.checkLogin({level:_62,success:dojo.hitch(_63,"_submit",url),fail:function(){_63.submitting=false;}});}},_submit:function(url){var _65=this;dojo.query("input[type=submit]").attr("disabled","disabled");_65.target_form.action=url;_65.target_form.onsubmit=function(){};_65.target_form.submit();},checkCompleteness:function(){var _66=this;return _66.check_receiver()&&_66.check_occasion_name();},check_receiver:function(_67){if(dojo.query(".invitee_row","network_invitees").length!=1){dojo.query(".errorHook","receiverSelectorContainer").addClass("error");dojo.query(".errorMsgIframe","selectedReceiverContainer").removeClass("hidden");return false;}else{dojo.query(".errorHook","receiverSelectorContainer").removeClass("error");dojo.query(".errorMsgIframe","selectedReceiverContainer").addClass("hidden");return true;}},check_occasion_name:function(_68){var _69=dojo.byId("occasion_name");var _6a=ff.t.findParent(_69,"generalBoxIframe");if(!_69.value){dojo.query(".errorMsgIframe",_6a).removeClass("hidden");dojo.query("#yourOccasionSelector,#occasionSelectorContainer").addClass("error");return false;}else{dojo.query(".errorMsgIframe",_6a).addClass("hidden");dojo.query("#yourOccasionSelector,#occasionSelectorContainer").removeClass("error");return true;}}});}
