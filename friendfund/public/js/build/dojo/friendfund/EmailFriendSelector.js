/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["friendfund.EmailFriendSelector"]){dojo._hasResource["friendfund.EmailFriendSelector"]=true;dojo.provide("friendfund.EmailFriendSelector");dojo.require("ff.t");dojo.require("ff.io");dojo.declare("friendfund._Selector",null,{_listener_locals:[],_loader:"<div style=\"margin: 0px auto;text-align:center;padding:30px;\"><div class=\"loading_animation\"><img src=\"/static/imgs/ajax-loader.gif\"></div></div>",draw:function(){},destoy:function(){},uninviteAppendNode:function(_1){},inviteAppendNode:function(_2){}});dojo.declare("friendfund.YourselfSelector",friendfund._Selector,{constructor:function(_3){dojo.mixin(this,_3);this.ref_node=dojo.isString(this.ref_node)&&dojo.byId(this.ref_node)||this.ref_node;},draw:function(){ff.io.xhrPost(this.base_url+"/validate",{"invitee.network":"yourself"},dojo.hitch(this,"_onSelect"));},_onSelect:function(_4){if(_4.success===true){this.onSelect(_4,_4.html,null);}else{dojo.place(_4.html,this.ref_node,"only");}},onSelect:function(_5,_6,_7){},undraw:function(){},destroy:function(){}});dojo.declare("friendfund.EmailFriendSelector",friendfund._Selector,{_listener_locals:[],rootNode:null,constructor:function(_8){dojo.mixin(this,_8);this.ref_node=dojo.isString(this.ref_node)&&dojo.byId(this.ref_node)||this.ref_node;},draw:function(){if(this.rootNode){dojo.removeClass(this.rootNode,"hidden");dojo.query("input[type=text]",this.rootNode)[0].focus();}else{this.rootNode=dojo.create("DIV",{"id":("networkinviter_"+this.network)});dojo.byId(this.ref_node).appendChild(this.rootNode);dojo.place(this._loader,this.rootNode,"only");ff.io.xhrPost(this.base_url+"/"+this.network,{},dojo.hitch(this,"onLoad"));}},onLoad:function(_9){dojo.place(_9,this.rootNode,"only");this._listener_locals.push(dojo.connect(this.ref_node,"onclick",this,"selectClick"));this._listener_locals.push(dojo.connect(this.ref_node,"onkeydown",dojo.hitch(this,ff.t.accessability,dojo.hitch(this,"select"),function(){})));ff.w.parseDefaultsInputs(this.rootNode);dojo.query("input[type=text]",this.rootNode)[0].focus();},undraw:function(){dojo.addClass(this.rootNode,"hidden");},destroy:function(){dojo.forEach(this._listener_locals,dojo.disconnect);this._listener_locals=[];},selectClick:function(_a){if(_a.target.id==="emailsubmitter"){this.select(_a);}},select:function(_b){var _c=dojo.byId("email_email");if(_c&&_c.value.length>0){ff.io.xhrFormPost(this.base_url+"/validate","emailinviter",dojo.hitch(this,"_onSelect"));}},_onSelect:function(_d){if(_d.success===true){this.onSelect(_d.html,null);dojo.place(_d.input_html,this.rootNode,"only");}else{dojo.place(_d.html,this.rootNode,"only");}var _e=dojo.query("input[type=text]",this.rootNode)[0];ff.w.parseDefaultsInputs(this.rootNode);if(_e){_e.focus();}},inviteAppendNode:function(_f){dojo.place(_f,this.invited_node,"last");dojo.query("input[type=text]","emailinviter").attr("value","");dojo.query("#email_inviter_error","emailinviter").orphan();},onSelect:function(_10,evt){dojo.query("p.inviterTwo",this.global_invited_node).addClass("hidden");this.inviteAppendNode(_10);var el=dojo.byId("invitedCounter");el.innerHTML=parseInt(el.innerHTML,10)+1;},unSelect:function(_11){dojo.query(_11).orphan();elem=dojo.byId("invitedCounter");elem.innerHTML=parseInt(elem.innerHTML,10)-1;}});}