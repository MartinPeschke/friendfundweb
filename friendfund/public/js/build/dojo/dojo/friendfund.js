/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

if(!dojo._hasResource["friendfund.EmailFriendSelector"]){dojo._hasResource["friendfund.EmailFriendSelector"]=true;dojo.provide("friendfund.EmailFriendSelector");dojo.provide("friendfund.EmailInPlaceSelector");dojo.declare("friendfund._Selector",null,{_listener_locals:[],_loader:"<div style=\"margin: 0px auto;text-align:center;padding:30px;\"><div class=\"loading_animation\"><img src=\"/static/imgs/ajax-loader.gif\"></div></div>",draw:function(){},destoy:function(){},uninviteAppendNode:function(_1){},inviteAppendNode:function(_2){}});dojo.declare("friendfund.EmailFriendSelector",friendfund._Selector,{_listener_locals:[],rootNode:null,constructor:function(_3){dojo.mixin(this,_3);this.ref_node=dojo.isString(this.ref_node)&&dojo.byId(this.ref_node)||this.ref_node;},draw:function(){if(this.rootNode){dojo.removeClass(this.rootNode,"hidden");dojo.query("input[type=text]",this.rootNode)[0].focus();}else{this.rootNode=dojo.create("DIV",{"id":("networkinviter_"+this.network)});dojo.byId(this.ref_node).appendChild(this.rootNode);dojo.place(this._loader,this.rootNode,"only");ff.io.xhrPost(this.base_url+"/"+this.network,{},dojo.hitch(this,"onLoad"));}},onLoad:function(_4){dojo.place(_4,this.rootNode,"only");this._listener_locals.push(dojo.connect(this.ref_node,"onclick",this,"selectClick"));this._listener_locals.push(dojo.connect(this.ref_node,"onkeydown",dojo.hitch(this,ff.t.accessability,dojo.hitch(this,"select"),function(){})));ff.w.parseDefaultsInputs(this.rootNode);dojo.query("input[type=text]",this.rootNode)[0].focus();},undraw:function(){dojo.addClass(this.rootNode,"hidden");},destroy:function(){this.rootNode=null;dojo.forEach(this._listener_locals,dojo.disconnect);this._listener_locals=[];},selectClick:function(_5){if(_5.target.id==="emailsubmitter"){this.select(_5);}},select:function(_6){var _7=dojo.byId("email_email");if(_7&&_7.value.length>0){ff.t.onSubmitCleaner(this.rootNode);ff.io.xhrFormPost(this.base_url+"/validate","emailinviter",dojo.hitch(this,"_onSelect"));}},_onSelect:function(_8){if(_8.success===true){this.onSelect(_8.html,null);dojo.place(_8.input_html,this.rootNode,"only");}else{dojo.place(_8.html,this.rootNode,"only");}var _9=dojo.query("input[type=text]",this.rootNode)[0];ff.w.parseDefaultsInputs(this.rootNode);if(_9){_9.focus();}},onSelect:function(_a,_b){this.inviteAppendNode(_a);var el=dojo.byId("invitedCounter");el.innerHTML=parseInt(el.innerHTML,10)+1;dojo.query("p.inviterTwo",this.global_invited_node).addClass("hidden");},unSelect:function(_c){dojo.query(_c).orphan();var _d=dojo.byId("invitedCounter");var _e=parseInt(_d.innerHTML,10)-1;_d.innerHTML=_e;if(_e===0){dojo.query("p.inviterTwo",this.global_invited_node).removeClass("hidden");}},inviteAppendNode:function(_f){dojo.place(_f,this.invited_node,"last");dojo.query("input[type=text]","emailinviter").attr("value","");dojo.query("#email_inviter_error","emailinviter").orphan();}});dojo.declare("friendfund.EmailInPlaceSelector",friendfund.EmailFriendSelector,{selectedValueNode:"selectedReceiver",constructor:function(_10){dojo.mixin(this,_10);this.selectedValueNode=dojo.byId(this.selectedValueNode);this.ref_node=dojo.isString(this.ref_node)&&dojo.byId(this.ref_node)||this.ref_node;},_onSelect:function(_11){var _12=this;if(_11.success===true){this.onSelect(_11.html,null);_12.selectedValueNode.value=_11.user_data;dojo.place(_11.html,this.rootNode,"only");dojo.query(".close",this.rootNode).onclick(dojo.hitch(this,"unSelect"));}else{dojo.place(_11.html,this.rootNode,"only");ff.w.parseDefaultsInputs(this.rootNode);}},onSelect:function(_13,evt){},unSelect:function(_14){this.selectedValueNode.value="";dojo.query(this.rootNode).orphan();this.destroy();this.draw();}});}if(!dojo._hasResource["friendfund.NetworkFriendSelector"]){dojo._hasResource["friendfund.NetworkFriendSelector"]=true;dojo.provide("friendfund.NetworkFriendSelector");dojo.provide("friendfund.FriendTypeAhead");dojo.declare("friendfund.NetworkFriendPanel",friendfund._Selector,{constructor:function(_15){dojo.mixin(this,_15);},draw:function(){ff.io.xhrPost(this.base_url+"/"+this.network,{},dojo.hitch(this,"onLoad"));},onLoad:function(_16){dojo.place(_16.html,this.ref_node,"only");dojo.style(this.ref_node,"display","Block");},destroy:function(){dojo.forEach(this._listener_locals,dojo.disconnect);this._listener_locals=[];},select:function(evt){var _17=ff.t.findParent(evt.target,"invitee_row");if(_17){return this.onSelect(_17,evt);}}});dojo.declare("friendfund.DataProvider",friendfund.NetworkFriendPanel,{_selected:{},constructor:function(_18){dojo.mixin(this,_18);this._rendering=false;this._current_display_idx=0;this._fully_loaded=false;this._search_index={};},addToSearchIndex:function(ud){ud["dom_id"]=this.network+"_"+ud.network_id;var s,_19,i,j,k,tmp,_1a={};s=ud.name.split(" ").concat([ud.name]);for(i=0;i<s.length;i++){_19=s[i];for(j=0;j<=_19.length;j++){k=_19.substr(0,j).toLowerCase();_1a[k]=true;}}for(k in _1a){tmp=this._search_index[k]||[];if(tmp.push){tmp.push(ud);this._search_index[k]=tmp;}}if(this.current_filter.length&&_1a[this.current_filter]){this.renderUserAndPlace(ud);}},_addPage:function(_1b,_1c){var i,ud;for(i=0;i<_1b.length;i++){ud=_1b[i];this.addToSearchIndex(ud);}this._fully_loaded=_1c;},renderSlice:function(_1d,_1e){var _1f=ff.t.render,_20=this.friends_template,sel=this._selected,_21=this.mutuals,si=this._search_index[this.current_filter||""]||[],_22=[],_23=[],len=si.length,i;for(i=this._current_display_idx;i<len;i++){if(!sel[si[i].dom_id]&&(!_21||_21&&si[i].mutual_with)){_22.push(si[i]);}if(_22.length<=_1d){this._current_display_idx++;}}len=_22.length>_1d?_1d:_22.length;for(i=0;i<len;i++){_23.push(_1f(_20,_22[i]));}if(_1e){_23.push("<li id=\"loading_placeholder_"+this.network+"\" class=\"clear\">&nbsp;</li>");}return _23;},getFirstPage:function(){this._current_display_idx=0;return this.renderSlice(this._page_size,true);},getNextPage:function(){return this.renderSlice(this._page_size);},hasMoreFriends:function(){return !this._fully_loaded||this._current_display_idx<this._search_index[this.current_filter||""].length;},reRender:function(){var _24=this.getFirstPage();if(_24.length){dojo.place(_24.join(""),this.friendlist,"only");this.onResultsFound();}else{delete dojo.query("*",this.friendlist).orphan();this.onNoResultsFound();}},onResultsFound:function(){},onNoResultsFound:function(){},_checkScrollingState:function(evt){friendlist_loader=dojo.byId("loading_placeholder_"+this.network);if(!friendlist_loader){return;}var pos=dojo.position(friendlist_loader);if(pos.y<this.friendlist_box){if(this.hasMoreFriends()){dojo.place(this.getNextPage().join(""),friendlist_loader,"before");}}},renderUserAndPlace:function(_25){dojo.place(ff.t.render(this.friends_template,_25),this.friendlist,"last");},addLoad:function(_26){if(_26.friends){this._addPage(_26.friends,_26.is_complete);if(!_26.is_complete){ff.io.xhrPost(this.base_url+"/ext_"+this.network,{offset:_26.offset},dojo.hitch(this,"addLoad"));}}},draw:function(){if(this.rootNode){dojo.removeClass(this.rootNode,"hidden");this.connect();}else{if(!this.is_selected()||this._is_loading!==true){this._is_loading=true;var l=dojo.query("#networkinviter_"+this.network);if(l.length){l.orphan();}this.rootNode=dojo.create("DIV",{"id":("networkinviter_"+this.network)});dojo.byId(this.ref_node).appendChild(this.rootNode);dojo.place(this._loader,this.rootNode,"only");ff.io.xhrPost(this.base_url+"/"+this.network,{},dojo.hitch(this,"onLoad"));}}}});dojo.declare("friendfund.NetworkFriendSelector",friendfund.DataProvider,{rootNode:null,_is_loading:false,_page_size:20,current_filter:"",constructor:function(_27){dojo.mixin(this,_27);if(this.invited_node){this.invited_node=dojo.isString(this.invited_node)&&dojo.byId(this.invited_node)||this.invited_node;}else{this.invited_node=null;}_is_selected_decider=".methodselector.ajaxlink.selected[_type="+this.network+"]";this.lazyReRender=ff.t.debounce(dojo.hitch(this,"reRender"),200,false);this.checkScrollingState=ff.t.debounce(dojo.hitch(this,"_checkScrollingState"),100,false);},is_selected:function(){return dojo.query(this._is_selected_decider,this.container).length>0;},connect:function(){},undraw:function(){if(this.rootNode){dojo.addClass(this.rootNode,"hidden");}else{var l=dojo.query("#networkinviter_"+this.network);if(l.length){l.orphan();}}dojo.forEach(this._listener_locals,dojo.disconnect);this._listener_locals=[];},onLoad:function(_28){var _29=this;_29._is_loading=false;dojo.place(_28.html,_29.rootNode,"only");if(_28.success){_29.friendlist=dojo.byId("friend_list_"+_29.network);_29.friendlist_box=dojo.position(_29.friendlist.parentNode);_29.friendlist_box=_29.friendlist_box.h*2+_29.friendlist_box.y;var _2a=dojo.byId("toggle_mutuals_"+_29.network);if(_2a){dojo.connect(_2a,"onclick",_29,"toggle_mutuals");_29.mutuals=_2a.checked;}else{_29.mutuals=false;}_29.friends_template=_28.template;_29._addPage(_28.friends,_28.is_complete);_29.reRender();_29.filterNode=dojo.byId("filter_"+_29.network);dojo.connect(_29.friendlist,"onclick",_29,"select");dojo.connect(_29.filterNode,"onkeyup",_29,"filter");ff.w.parseDefaultsInputs(_29.ref_node);dojo.connect(_29.friendlist.parentNode,"onscroll",this.checkScrollingState);if(!_28.is_complete){ff.io.xhrPost(_29.base_url+"/ext_"+_29.network,{offset:_28.offset},dojo.hitch(_29,"addLoad"));}}else{dojo.query("a.facebookBtn",_29.rootNode).forEach(function(_2b){level=parseInt(dojo.attr(_2b,"_level"),10);dojo.connect(_2b,"onclick",dojo.hitch(_29.auth_provider,"doFBLogin",{level:level,success:dojo.hitch(_29,"draw")}));});dojo.query("a.twitterBtn",_29.rootNode).forEach(function(_2c){level=parseInt(dojo.attr(_2c,"_level"),10);dojo.connect(_2c,"onclick",dojo.hitch(_29.auth_provider,"doTWLogin",{level:level,success:dojo.hitch(_29,"draw")}));});_29.rootNode=null;}},onSelect:function(_2d,evt){this.checkScrollingState();dojo.query("p.inviterTwo",this.global_invited_node).addClass("hidden");this.inviteAppendNode(_2d);var el=dojo.byId("invitedCounter");el.innerHTML=parseInt(el.innerHTML,10)+1;},inviteAppendNode:function(_2e){var _2f=this;dojo.query(_2e).orphan().forEach(function(_30){dojo.place(_30,_2f.invited_node,"last");_2f._selected[_30.id]=true;});},uninviteAppendNode:function(_31){delete this._selected[_31.id];this.lazyReRender();},unSelect:function(_32){var _33=this;dojo.query(_32).orphan().forEach(function(_34){_33.uninviteAppendNode(_34);var ctr=dojo.byId("invitedCounter");var _35=parseInt(ctr.innerHTML,10)-1;ctr.innerHTML=_35;if(_35===0){dojo.query("p.inviterTwo",_33.global_invited_node).removeClass("hidden");}});},toggle_mutuals:function(evt){this.mutuals=evt.target.checked;this.lazyReRender();},filter:function(evt){if(evt.keyCode==27){this.filterNode.value="";this.current_filter="";}else{if(evt.keyCode<45&&evt.keyCode!=8){return;}}this.current_filter=this.filterNode.value.toLowerCase();this.lazyReRender();}});dojo.declare("friendfund.FriendTypeAhead",friendfund.DataProvider,{rootNode:null,_is_loading:false,_page_size:5,current_filter:"",_has_results:false,selectedValueNode:"selectedReceiver",constructor:function(_36){dojo.mixin(this,_36);this._is_selected_decider=".methodselector.ajaxlink.selected[_type="+this.network+"]";this.lazyReRender=ff.t.debounce(dojo.hitch(this,"reRender"),100,false);this.mutuals=false;this.selectedValueNode=dojo.byId(this.selectedValueNode);this.checkScrollingState=ff.t.debounce(dojo.hitch(this,"_checkScrollingState"),100,false);},is_selected:function(){return dojo.query(this._is_selected_decider,this.container).length>0;},connect:function(){this._listener_locals.push(dojo.connect(this.friendlist,"onclick",this,"select"));this._listener_locals.push(dojo.connect(this.filterNode,"onkeyup",this,"filter"));this._listener_locals.push(dojo.connect(window,"onclick",this,"onHideSelector"));this._listener_locals.push(dojo.connect(this.filterNode,"onfocus",this,"onShowSelector"));this._listener_locals.push(dojo.connect(this.friendlist.parentNode,"onscroll",this.checkScrollingState));},onHideSelector:function(evt){if(!ff.t.findParent(evt.target,"typeAheadSelector")){this.hideSelector();}},hideSelector:function(){var pn=ff.t.findParent(this.friendlist,"friendsList");dojo.addClass(pn,"hidden");},onShowSelector:function(evt){evt.target.select();this.reRender();var tmp=dojo.position(this.friendlist.parentNode);this.friendlist_box=this.friendlist_box||tmp.y+tmp.h*1.5;},showSelector:function(){if(this._has_results){var pn=ff.t.findParent(this.friendlist,"friendsList");dojo.removeClass(pn,"hidden");}},undraw:function(){if(this.rootNode){dojo.addClass(this.rootNode,"hidden");}else{var l=dojo.query("#networkinviter_"+this.network);if(l.length){l.orphan();}}dojo.forEach(this._listener_locals,dojo.disconnect);this._listener_locals=[];},onLoad:function(_37){var _38=this;_38._is_loading=false;dojo.place(_37.html,_38.rootNode,"only");if(_37.success){_38.friendlist=dojo.byId("friend_list_"+_38.network);_38.friends_template=_37.template;_38._addPage(_37.friends,_37.is_complete);_38.filterNode=dojo.byId("filter_"+_38.network);ff.w.parseDefaultsInputs(_38.ref_node);_38.connect();if(!_37.is_complete){ff.io.xhrPost(_38.base_url+"/ext_"+_38.network,{offset:_37.offset},dojo.hitch(_38,"addLoad"));}}else{dojo.query("a.facebookBtn",_38.rootNode).forEach(function(_39){level=parseInt(dojo.attr(_39,"_level"),10);dojo.connect(_39,"onclick",dojo.hitch(_38.auth_provider,"doFBLogin",{level:level,success:dojo.hitch(_38,"draw")}));});dojo.query("a.twitterBtn",_38.rootNode).forEach(function(_3a){level=parseInt(dojo.attr(_3a,"_level"),10);dojo.connect(_3a,"onclick",dojo.hitch(_38.auth_provider,"doTWLogin",{level:level,success:dojo.hitch(_38,"draw")}));});_38.rootNode=null;}},onResultsFound:function(){this._has_results=true;this.showSelector();},onNoResultsFound:function(){this._has_results=false;this.hideSelector();},onSelect:function(_3b,evt){this.inviteAppendNode(_3b);},inviteAppendNode:function(_3c){var _3d=this;var pn=ff.t.findParent(_3d.friendlist,"typeAheadSelector");dojo.query("img.smallProfPic",pn).orphan();dojo.query("img",_3c).forEach(function(n){var _3e=dojo.create("IMG",{src:n.src,className:"smallProfPic"});dojo.place(_3e,pn,"first");});var _3f=dojo.query("input",_3c);if(_3f.length){_3d.selectedValueNode.value=_3f[0].value;}_3d.filterNode.value=dojo.query("p",_3c).attr("innerHTML").join("");_3d.current_filter=_3d.filterNode.value.toLowerCase();dojo.query(_3d.filterNode).removeClass("default").addClass("selected");_3d.reRender();_3d.onNoResultsFound();},uninviteAppendNode:function(_40){},unSelect:function(_41){},filter:function(evt){if(evt.keyCode==27){this.filterNode.value="";this.current_filter="";}else{if(evt.keyCode<45&&evt.keyCode!=8){return;}}this.current_filter=this.filterNode.value.toLowerCase();this.lazyReRender();}});}if(!dojo._hasResource["friendfund.CompoundFriendSelector"]){dojo._hasResource["friendfund.CompoundFriendSelector"]=true;dojo.provide("friendfund.CompoundFriendSelector");dojo.declare("friendfund.CompoundFriendSelector",null,{_widget_locals:[],_listener_locals:[],selectors:{},constructor:function(_42){var _43=this;dojo.mixin(_43,_42);this.networkSelector=this.networkSelector||friendfund.NetworkFriendSelector;this.emailSelector=this.emailSelector||friendfund.EmailFriendSelector;if(_42.avail_selectors.facebook===true){_43.selectors.facebook=new this.networkSelector({container:_43.container,auth_provider:_43.auth_provider,ref_node:_43.ref_node,invited_node:"network"+_43.invited_node_suffix,global_invited_node:_43.global_invited_node,base_url:_43.base_url,network:"facebook"});}if(_42.avail_selectors.twitter===true){_43.selectors.twitter=new this.networkSelector({container:_43.container,auth_provider:_43.auth_provider,ref_node:_43.ref_node,invited_node:"network"+_43.invited_node_suffix,global_invited_node:_43.global_invited_node,base_url:_43.base_url,network:"twitter"});}if(_42.avail_selectors.email===true){_43.selectors.email=new this.emailSelector({ref_node:_43.ref_node,auth_provider:_43.auth_provider,invited_node:"network"+_43.invited_node_suffix,global_invited_node:_43.global_invited_node,base_url:_43.base_url,network:"email"});}for(var sel in _43.selectors){var s=_43.selectors[sel];if(_43.selectors.hasOwnProperty(sel)&&_43.selectors[sel]){if(_43.onSelect){s.onSelect=dojo.hitch(s,_43.onSelect);}if(_43.unSelect){s.unSelect=dojo.hitch(s,_43.unSelect);}_43._widget_locals.push(s);}}if(_43.invited_node_suffix){_43._listener_locals.push(dojo.connect(dojo.byId(_43.global_invited_node),"onclick",_43,"unselect"));}var _44=dojo.byId("removeall");if(_44){_43._listener_locals.push(dojo.connect(_44,"onclick",_43,"removeAll"));}},removeAll:function(){var _45=this;dojo.query(".invitee_row.selectable",_45.global_invited_node).forEach(function(_46){_45.selectors[dojo.attr(_46,"_network")].unSelect(_46);});},unselect:function(evt){var _47=ff.t.findParent(evt.target,"invitee_row");if(!_47||!dojo.hasClass(_47,"selectable")){return;}this.selectors[dojo.attr(_47,"_network")].unSelect(_47);},destroy:function(){dojo.forEach(this._listener_locals,dojo.disconnect);this._listener_locals=[];dojo.forEach(this._widget_locals,function(_48){_48.destroy();});this._widget_locals=[];},switchMethod:function(evt){var _49=this,_4a=evt.target,_4b=dojo.attr(_4a,"_type"),_4c=_49.selectors[_4b],_4d=dojo.byId("networkinvitermethod");if(dojo.hasClass(_4a,"selected")){return;}dojo.query(".ajaxlink.selected",_49.container).forEach(function(_4e){dojo.removeClass(_4e,"selected");var _4f=_49.selectors[dojo.attr(_4e,"_type")];if(_4f){_4f.undraw();}});dojo.addClass(_4a,"selected");if(_4d){_4d.value=_4b;}if(_4c){_4c.draw();}},draw:function(_50){var _51=this;_51.selectors[_50].draw();dojo.query(".ajaxlink",_51.container).forEach(function(_52){_51._listener_locals.push(dojo.connect(_52,"onclick",_51,"switchMethod"));});}});}if(!dojo._hasResource["friendfund.InvitePage"]){dojo._hasResource["friendfund.InvitePage"]=true;dojo.provide("friendfund.InvitePage");dojo.declare("friendfund.InvitePage",null,{selector:null,_listener_locals:[],_widget_locals:[],submitting:false,constructor:function(_53){var _54=this;dojo.mixin(_54,_53);_54.selector=new friendfund.CompoundFriendSelector({auth_provider:_54.auth_provider,container:_54.container,ref_node:"inviter",invited_node_suffix:"_invitees",inviter_node:"friend_list",base_url:_54.base_url,global_invited_node:_54.invited_node,avail_selectors:{"facebook":true,"twitter":true,"email":true}});_54._widget_locals.push(_54.selector);dojo.connect(document,"onclick",dojo.hitch(null,_54.loadPreviewPopup,_54,_54.method));},loadPreviewPopup:function(_55,_56,evt){if(dojo.hasClass(evt.target,"message_preview")){dojo.query("input.addRefContent",_55.target_form).forEach(function(_57){_57.value=dojo.byId(dojo.attr(_57,"_source")).value;});params=dojo.formToObject(_55.target_form);params.method=dojo.attr(evt.target,"_method");ff.io.xhrPost(dojo.attr(evt.target,"_href"),params);}},prepareSubmit:function(_58,_59,evt){ff.t.onSubmitCleaner(_58.target_form);if(_58.submitting){return false;}_58.submitting=true;return _58.auth_provider.checkLogin({level:_59,success:dojo.hitch(_58,"_submit"),fail:function(){_58.submitting=false;}});},_submit:function(){var _5a=this;dojo.forEach(_5a._widget_locals,function(_5b){_5b.destroy(_5b);});_5a._widget_locals=[];_5a.receiver_selectors={};dojo.query("input.addRefContent",_5a.target_form).forEach(function(_5c){_5c.value=dojo.byId(dojo.attr(_5c,"_source")).value;});dojo.query("input.addRefCheckbox",_5a.target_form).forEach(function(_5d){var _5e=dojo.byId(dojo.attr(_5d,"_source"));if(_5e.checked){_5d.value=_5e.value;}else{dojo.query(_5d).orphan();}});dojo.byId(_5a.target_form).submit();}});}if(!dojo._hasResource["friendfund.PartnerPage"]){dojo._hasResource["friendfund.PartnerPage"]=true;dojo.provide("friendfund.PartnerPage");dojo.declare("friendfund.PartnerPage",null,{connect:function(){dojo.connect(dojo.byId("occasionSelector"),"onchange",this,"swapOccasionName");dojo.connect(dojo.byId("occasionTyper"),"onkeyup",this,"changeOccasionName");},changeOccasionName:function(evt){if(evt.target.value){dojo.byId(dojo.attr(evt.target,"_target")).value=evt.target.value;}else{var _5f={target:dojo.byId("occasionSelector")};this.swapOccasionName(_5f);}this.check_occasion_name();},swapOccasionName:function(evt){var _60=evt.target.options[evt.target.selectedIndex];dojo.byId(dojo.attr(evt.target,"_name_target")).value=_60.value;dojo.byId(dojo.attr(evt.target,"_key_target")).value=dojo.attr(_60,"key");this.check_occasion_name();},constructor:function(_61){dojo.mixin(this,_61);this.triedSubmitting=false;this.target_form=dojo.isString(this.target_form)&&dojo.byId(this.target_form)||this.target_form;this.load_receiver();this.connect();dojo.byId("selectedReceiver").value="";},load_receiver:function(){this.selector=new friendfund.CompoundFriendSelector({auth_provider:this.auth_provider,container:this.container,ref_node:"inviter",inviter_node:"friend_list",base_url:this.base_url,avail_selectors:{"facebook":true,"twitter":true,"email":true},networkSelector:friendfund.FriendTypeAhead,emailSelector:friendfund.EmailInPlaceSelector});this.selector.draw(this.method);},submit:function(url,_62,evt){var _63=this;var _64=_63.checkCompleteness();if(!_64||_63.submitting){return false;}else{ff.t.onSubmitCleaner(_63.target_form);_63.submitting=true;return _63.auth_provider.checkLogin({level:_62,success:dojo.hitch(_63,"_submit",url),fail:function(){_63.submitting=false;}});}},_submit:function(url){var _65=this;dojo.query("input[type=submit]").attr("disabled","disabled");_65.target_form.action=url;_65.target_form.onsubmit=function(){};_65.target_form.submit();},checkCompleteness:function(){var _66=this;return _66.check_receiver()&&_66.check_occasion_name();},check_receiver:function(_67){if(dojo.query(".invitee_row","network_invitees").length!=1){dojo.query(".errorHook","receiverSelectorContainer").addClass("error");dojo.query(".errorMsgIframe","selectedReceiverContainer").removeClass("hidden");return false;}else{dojo.query(".errorHook","receiverSelectorContainer").removeClass("error");dojo.query(".errorMsgIframe","selectedReceiverContainer").addClass("hidden");return true;}},check_occasion_name:function(_68){var _69=dojo.byId("occasion_name");var _6a=ff.t.findParent(_69,"generalBoxIframe");if(!_69.value){dojo.query(".errorMsgIframe",_6a).removeClass("hidden");dojo.query("#yourOccasionSelector,#occasionSelectorContainer").addClass("error");return false;}else{dojo.query(".errorMsgIframe",_6a).addClass("hidden");dojo.query("#yourOccasionSelector,#occasionSelectorContainer").removeClass("error");return true;}}});}
