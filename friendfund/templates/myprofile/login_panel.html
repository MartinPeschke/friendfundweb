<%namespace name="html" file="../widgets/html_elems.html"/>
<%namespace name="forms" file="../widgets/forms.html"/>
<%namespace name="login_panel_content" file="login_panel_content.html"/>



<div id="loginpanel">
	%if c.user.is_anon:
		${login_panel_content.render(getattr(c, "expanded", False))|n}
		
		<span class="login_loginlink narrow">${_(u"PANEL_LOGIN_Login with")}</span>
		<a onclick="fbLogin()" class="login_loginlink narrow first"><img  class="floaterLeft" src="/static/imgs/icon_fb_connect.png"/></a>
		<a onclick="twInit('${getattr(c, 'furl', url('home'))}')" class="narrow login_loginlink"><img class="floaterLeft" src="/static/imgs/icon_tw_connect.png"/></a>
		<a id="loginlink" class="login_loginlink somelink ${getattr(c, "expanded", False) and 'selected' or ''}" onclick="toggleLoginPanel(this)"><span>${_("PANEL_LOGIN_Log In")}</span></a>
		<span class="login_loginlink" style="padding:0px;">|</span>
		<a href="${url('index', action='signup')}?furl=${getattr(c, 'furl', url('home'))}" class="somelink login_loginlink"><span>${_("PANEL_LOGIN_Sign Up")}</span></a>
		
		
		<script type="text/javascript">
		closeLoginPanel = function(evt){
			if(dojo.hasClass("loginlink", "selected")){
				dojo.removeClass("loginlink", "selected");
				dojo.addClass("loginPanelContent", "hidden");
			}
		}
		toggleLoginPanel = function(link){
			if(dojo.hasClass(link, "selected")){
				dojo.removeClass(link, "selected");
				dojo.addClass("loginPanelContent", "hidden");
			} else {
				dojo.addClass(link, "selected");
				dojo.removeClass("loginPanelContent", "hidden");
			}
		}
		document.onkeydown = function(evt){if(evt.keyCode == 27){closeLoginPanel(evt);}}
		</script>
		
	%else:
		<a class="login_loginlink somelink " href="${url('controller', controller='mypools')}">
			<span class="name login_loginlink">${_("PANEL_LOGIN_Welcome")}</span>
			<img id="login_panel_profile_pic" src="${c.user.get_profile_pic()}"/>
			<span class="name login_loginlink">${c.user.name or c.user.email}</span></a>
		%if 'facebook' not in c.user.networks:
			<a onclick="fbLogin()" class="somelink login_loginlink"><img src="/static/imgs/icon_fb_connect.png"/></a>
		%endif
		<a class="somelink login_loginlink" onclick="fbLogout();">${_("PANEL_LOGIN_logout")}</a>
	%endif
</div>
