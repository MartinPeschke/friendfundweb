<%inherit file="layout.html"/>
<%namespace name="testimonials" file="widgets/testimonials.html" />
<%namespace name="widgets" file="widgets/widgets.html" />
<%namespace name="links" file="/widgets/links.html"/>
<%def name="onloadscripts()">
	parseDefaultsInputs("poolProductFinder");
	parseSelectables("poolProductFinder", "showToolTipHook", "showToolTip");
	connectURLParser("submissionform", "home_title", true);
	sliderF("merchantslider", 4);
</%def>
<%def name="render_page_state()">window.pageState.fwd = function(login){window.location.href="${url(controller="mypools", action="stream")}";};</%def>


<div class="wrapSubHeaderHome">
	<div class="subHeader">
		<div class="homeFrame">
			<div class="imageFrame"><img src="/static/imgs/dummy/vimeo.png"/></div>
			<div class="shadCorner"></div>
		</div>
		<div class="homeFrame">
			<div class="fullLRPadding">
				<h2><p>${_("FF_HOMEPAGE_SLOGAN_friendfund it.")}</p><span>${_("FF_HOMEPAGE_SLOGAN_Collect money by creating a pool and inviting friends to chip in.")}</span></h2>
				<div class="getStarted clearer floatLeft">
				<a class="nolink" href="${h.create_pool_link(request, url)}">
					<span class="upperText">${_("Get Started")}
						<span class="lowerText">${_("Get Started")}</span>
						<span class="lowestText">${_("Get Started")}</span>
					</span>
				</a>
				</div>
			</div>
		</div>
		<div class="clearer" style="width:100%;height:60px;">
			<a href="${url("short_content", lang=session["lang"], action="tips", host=app_globals.default_host)}" class="learnMoreBtnNew floatLeft">${_("FF_HOMEPAGE_SLOGAN_Learn more")}</a>
			<div class="floatRight" style="padding:18px 0 0">
			<a href="http://twitter.com/share" class="twitter-share-button floatLeft" data-url="http://www.friendfund.com" data-count="horizontal">Tweet</a>
			<iframe src="https://www.facebook.com/plugins/like.php?href=www.facebook.com%2Ffriendfund&amp;layout=button_count&amp;show_faces=false&amp;width=200&amp;action=like&amp;font=arial&amp;colorscheme=light&amp;height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:120px; height:21px;" allowTransparency="true"></iframe>
			</div>
			<div class="floatRight homeListing" style="padding:20px 10px 0 0">
				<div class="floatLeft"><b>253</b>Pools</div>
				<div class="floatLeft"><b>1,206</b>Contributors</div>
			</div>
		</div>
		<div class="homeDivider"></div>
		<div class="clearer">
			<div class="referers floatLeft"><img src="/static/imgs/TechCrunch_logo_bw.png" alt="TechCrunch"/>
				<em>“All of sudden, so-called social commerce seems a tad more viable.”</em>
			</div>
			<div class="referers floatLeft"><img src="/static/imgs/gigaom_bw.png" alt="GigaOm"/>
				<em>“Retailers are now waking up to the opportunity.”</em>
			</div>
			<div class="referers floatLeft"><img src="/static/imgs/zanox-bw.png" alt="Zanox"/>
				<em>“Conference and exhibition in San Diego next month.”</em>
			</div>
			<div class="referers last floatLeft"><img src="/static/imgs/iw-bw.png" alt="Internet Business World"/>
				<em>“Ich erwarte ein enormes virales Wachstum in 2011”</em>
			</div>
			<div class="clear"></div>
		</div>
	</div>
	<div class="shadowHome"></div>
</div>
<div class="wrapSubContent">
${self.renderMessages()}
<div class="content">
	<div class="featuredPoolsBox">
		<h4>${_("FF_HOMEPAGE_BOXES_Featured Pools")}</h4>
		${self.render_featured_pools(c.get_featured_pools, h.get_language_locale())|n}
		<div class="clear"></div>
	</div>
	<div class="colRightWhite"></div>
	<div class="whatElse">
		<h4>${_("FF_HOMEPAGE_BOXES_Where else can I use friendfund?")}<span>${_("FF_HOMEPAGE_Visit our Partner site to buy stuff toghether.")}</span></h4>
		${self.renderScroller()|n}
		<div class="clear"></div>
	</div>
	<div class="whatElse">
			<h4>${_("FF_HOMEPAGE_What our users are saying")}</h4>
			${testimonials.render(h.get_language_locale())|n}
		<div class="clear"></div>
	</div>
	<div class="clear"></div>
</div>
</div>




<%def name="renderScroller()" cached="False" cache_key="renderScroller_templ" cache_timeout="86400" cache_type="memory">
	
<%
	list = [#("/static/imgs/integrations/amazon_trans.png", "http://amazon.friendfund.com"),
			("/static/imgs/integrations/yoquero_trans.png", "http://www.yoquierounodeesos.com/"),
			("/static/imgs/integrations/GAD_trans.png", "http://www.greatamericandays.com/adventure.php?adventure_id=11&price=&category=2&finder=52&imageField.x=9&imageField.y=12"),
			("/static/imgs/integrations/shopperella_trans.png", "http://www.shopperella.de/kinderzimmer-zwei-tuerig/pinolino-kinderzimmer-laura-629/"),
			("/static/imgs/integrations/donanda_trans.png", "http://www.donanda.de/pages/affiliate/1090"),
			("/static/imgs/integrations/fidorbank_trans.png", "https://www.fidor.de/"),
			("/static/imgs/integrations/caseable_trans.png", "http://www.caseable.com/gallery.php")
		]
%>
	<div class="boxGrayWrap box1" id="merchantslider">
		<div class="boxGray">
		<span class="controller controllerRight"> &laquo; </span>
		<span class="controller controllerLeft"> &raquo; </span>
		<div class="slider">
		<ul class="slider" id="sliderCnt" style="width:${len(list)*219}px" _elem_width="219">
			%for img, href in list:
				<li><a target="_blank" href="${href}"><img src="${img}" /></a></li>
			%endfor
		</ul>
		</div>
			<div class="clear"></div>
		</div>
	</div>
</%def>


<%def name="render_featured_pools(get_featured_pools, lang)" cached="True" cache_key="render_featured_pools_${lang}" cache_timeout="60" cache_type="memory">
	%for i, pool in enumerate(get_featured_pools()):
		<% locals = {"number_contributors":pool.get_number_of_contributors(), "days_left":pool.get_remaining_days(), "admin_name":pool.admin.name} %>
	<div class="homeboxWrap ${i==3 and 'omega' or ''}">
   
		<div class="homebox">
			<img src="${pool.get_product_display_picture("FF_POOLS")}" width="190px" height="150px" />
			<h5 style="min-height:36px;"><a href="${url("get_pool", pool_url = pool.p_url)}">${pool.title}</a></h5>
			<span class="homebox">${_("FF_HOMEPAGE_BOXES_created by %(admin_name)s")%locals}</span>
			<div class="timeCounter">
				<span>${int(pool.funding_progress()*100)}%</span>
				<div class="timeCounterRight" >
					<div class="timeCounterLeft" style="width:${int(pool.funding_progress()*100)}%"> </div>
				</div>
				<div class="clear"></div>
			</div>
			
			<div class="boxContributors">
				<span class="upper">${widgets.renderPoolInfoContributors(locals)|n}</span>
				<span class="middot">&middot;</span>
				<span class="upper">${widgets.renderPoolInfoDaysLeft(locals)|n}</span>
			</div>
			<div class="fbHolder">
				%for pu in pool.get_random_n_invitees(5):
					<img src="${pu.get_profile_pic("PROFILE_S")}" alt="${pu.name}" height="30px" width="30px"/>
				%endfor
				<div class="clear"></div>
			</div>
		</div>
    
	</div>
	
	%endfor
</%def>