<%inherit file="../layout.html"/>
<%namespace name="links" file="../widgets/links.html"/>
<%def name="scripts_styles()">
	${links.js('datepicker.packed.js')}
	${links.css('datepicker.css')}
</%def>
<%def name="onloadscripts()">
	parseDefaultsInputs("poolDetails");
	parseEditables("poolDetails");
	var today = new Date();
	if(dojo.byId("datepicker").value){
		var date = new Date(dojo.byId("dateValue").value);
		dojo.byId("daysLeft").innerHTML = Math.ceil((date.getTime()-today.getTime())/(24*3600*1000));
	}
	datePickerController.createDatePicker({
	  formElements:{"datepicker":"d-dt-m-dt-Y"},
	  rangeLow:today.getFullYear() + "" + lpad(today.getMonth()+1) + lpad(today.getDate()), 
	  callbackFunctions:{"dateset":[
			function(params){
				if(params.date){
					dojo.byId("daysLeft").innerHTML = Math.ceil((params.date.getTime()-(today).getTime())/(24*3600*1000));
					dojo.byId("dateValue").value=params.yyyy+"-"+lpad(params.mm)+"-"+lpad(params.dd);
				} else {
					alert("Please Input a Date greater than "+lpad(today.getDate())+ "." + lpad(today.getMonth()+1) +"." +today.getFullYear() , +"!");
				}
			}
		]}
	});
	%if getattr(c.pool.product, "tracking_link", False):
		var hue = document.getElementById("homeurlexpander");
		hue.appendChild(renderController());
		hue.insertBefore(renderPictures(["${'","'.join(c.images)|n}"], "${c.pool.product.picture}"), hue.firstChild);
	%endif
</%def>

<div class="wrapSubHeader">
	<div class="subHeader">
		<div class="userProfile">
			<div class="nonPoolHeader">
				<h2>Step 2. Enter Your Pool Details</h2>
				
			</div>
			<div class="steps">
				<div class="stepOne"><span>1</span>What are you collecting money for?</div>
				<div class="rightArrow"></div>
				<div class="leftArrow"></div>
				<div class="stepTwo active"><span>2</span>Enter pool details</div>
				<div class="rightArrow active"></div>
				<div class="leftArrow active"></div>
				<div class="stepThree"><span>3</span>Invite friends to chip in</div>
			
			</div>
		<div class="clear"></div>
		</div>
	</div>
</div>
<div class="content">
  <div class="colRight"></div>
	<div class="colLeft">
		<form method="POST" onSubmit="onSubmitCleaner(this)" action="${url('pool_create', pd=c.pd)}">
		<div class="poolDets" id="poolDetails">
			<h4>Pool Details</h4>
			<div class="borderBottom">
				<div class="first" style="margin-top:8px; width:135px"><span>We Need</span> <span class="editable active" _elem="currency" _value="${c.pool.currency}">${h.display_currency(c.pool.currency)}</span></div>
				<div class="greyInside" style="width:521px">
					<input type="text" value="${h.format_number(c.pool.get_amount_float())}" class="small default" />
					<span style="margin-left:40px; margin-right:5px">by</span>
					<input class="small default" type="text" id="datepicker" value="${getattr(c.pool.occasion, "display_date", "")}"/>
					<input type="hidden" name="occasion.date" id="dateValue" value="${getattr(c.pool.occasion, "internal_date_format", "")}"/>
				<span class="darkGrey floatRight"><span class="bold" id="daysLeft">0</span> DAYS LEFT</span>
			</div>
			</div>
			<div class="borderBottom selected">
				<div class="tip">
					<div class="arrow"></div>
					<span>Tip goes here Tip goes here Tip goes here Tip goes here Tip goes here Tip goes here</span>
				</div>
				<div class="greyInsideFullWidth">
				<div class="first">
					<span>Pool Title</span>
				</div>
					<input type="text" name="title" _default_text="Write your title here..." class="default" value="${c.pool.title or "Write your title here..."}" />
				</div>
			</div>
			<div class="borderBottom selected error">
            	<div class="tip">
					<div class="arrow"></div>
					<span>Tip goes here Tip goes here Tip goes here Tip goes here Tip goes here Tip goes here</span>
				</div>
            	<div class="greyInsideFullWidth">
				<div class="first">
					<span>Pool Description</span>
				</div>
				<div class="containerTxtArea">
					<textarea name="description" _default_text="Write your description here..." class="default">${c.pool.description or "Write your description here..."}</textarea>
				</div>
                </div>
			</div>
			%if getattr(c.pool.product, "tracking_link", False):
				<div class="borderBottom">
					<div id="homeurlexpander" class="home_expander">
						<input type="hidden" id="productPicture" value="${c.pool.product.picture}" />
						
						<div class="title editable active" _elem="prodname" _value="${c.pool.product.name}">${c.pool.product.name}</div>
						<a class="address smallAddress" href="${c.pool.product.tracking_link}">${c.pool.product.get_display_link()}</a>
						<div class="desc editable active" _elem="proddesc" _value="${c.pool.product.description}">${c.pool.product.get_display_description()}</div>
					</div>
				</div>
			%else:
				<div class="borderBottom">
					<div class="first">
						<span>Upload an image</span>
					</div>
					<div class="imgContainer">
						<img src="/static/imgs/dummy/dummy-img-big.jpg">
					</div>
					<div class="choose">
						<span class="bold">Choose a file from your computer</span><br>
						<input type="button" value="Choose file" /><span>No file chosen</span>
						<p>JPEG, PNG or GIF. MAX FILE SIZE: 5 MB</p>
						<span class="bold">...or upload an image using a URL</span>
						<input type="text" style="width:336px; margin:5px 0 0 0"/>
					</div>
				</div>
			%endif
			<div class="clear"></div>
		</div>
	

		<div class="recMoney">
			<h4>Receiving Your Money</h4>
			<div class="receiveMoney">
				<p>How do you want to receive your money once the Pool is funded? 
					<span>You will only be paid if your Pool is successfully funded. This information will not be shared with anyone else.</span>
				</p>
				<div><input type="radio" onclick="this.checked?dojo.removeClass('paypalForm', 'hidden'):null;" 
							name="settlementOption" value="paypal" checked="checked" id="paypalSettlement" class="chkbox" />
					<label for="paypalSettlement">Paypal</label>
				</div>
				<div id="paypalForm">
				<div class="smallLabel"><label>Paypal Account Email Address</label><input type="text" name="paypal.email" /></div>
				<div class="smallLabel"><label>First Name</label><input type="text" name="paypal.firstname" /></div>
				<div class="smallLabel"><label>Last Name</label><input type="text" name="paypal.lastname" /></div>
				</div>
				<div><input type="radio" onclick="this.checked?dojo.addClass('paypalForm', 'hidden'):null;" name="settlementOption" id="amazonSettlement" value="amazon" class="chkbox" />
					<label for="amazonSettlement">Amazon Vouchers</label>
				</div>
			</div>
			<div class="clear"></div>
		</div>
		<input type="submit" value="submit"/>
	</form>
</div>


<div class="clear"></div>

</div>

